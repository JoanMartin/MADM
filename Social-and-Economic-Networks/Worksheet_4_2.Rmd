---
title: "Social and economic networks"
subtitle: "Handout 4.B"
author: "Juan José Martín, Christian Strasser"
output:
  html_document:
    number_sections: false
    highlight: tango
    toc: yes
    df_print: paged
editor_options: 
  chunk_output_type: console
---



<style type="text/css">

  body {
    background-color: #f6f7fd; 
  }
  
  a:link {
    color: #0174DF;
  }
  
  code.r {
    font-size: 14px;
  } 
  
  div pre {
    background-color:#E0ECF8;
  }
  pre {
    font-size: 14px 
  }
 
  p {
    text-align: justify;
  }
 
    
  h1, h2, h3, h4, h5, h6 {
    color: #737aaa;
  }

  th {  
    background-color:#737aaa;
    color: #FAFAFA;
    padding:5px;
  }
  
  td {
    font-size: 11.5pt;
  } 
  
  tr:nth-child(even){
    background: white;
  }
  
  tr:nth-child(odd){ 
    background-color: #EFF8FB;
  }
</style>

***     

<br/>    
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(igraph)
rm(list = ls())
```

## 2)

The file WikiVote.txt is a data table containing the votations on promotion to administratorship of Wikipedia (till January 2008). Each arc (x; y) in it means that user x voted on y becoming Wikipedia administrator. More details at http://snap.stanford.edu/data/wiki-Vote.html.

Download it on your computer and upload it to R as a dataframe. Define a directed graph DW with this list of arcs, and the underlying unweighted undirected graph UW.**

```{r}
df = read.table("Wiki-Vote.txt", sep = "\t")
DW = graph_from_data_frame(df, directed = TRUE)
UW = graph_from_data_frame(df, directed = FALSE)
```
### (a)

**Does DW contain self-loops? How many?**

```{r}
sum(which_multiple(DW))
sum(which_multiple(UW))
```

**What do self-loops mean, in the context of this graph? **

Bucles propios en este contexto significa que ese participante (nodo) se ha votado a si mismo.

**If any, remove them (as well as from UW).**

```{r}
DW_S = simplify(UW)
```

###(b)

**What are the order and size of DW? What is the size of UW? What does the difference in sizes correspond to?**

```{r}
gorder(DW_S)
gsize(DW_S)
```
```{r}
gorder(DW)
gsize(DW)
```

###(c)

**Does DW have a giant weakly connected component? And a giant strongly connected component?**

```{r}
GWC_DW = induced_subgraph(DW, v=groups(components(DW_S, mode = "weak"))[[1]])
GSC_DW = induced_subgraph(DW, v=groups(components(DW_S, mode = "strong"))[[1]])
```

```{r}
```

###(d) 

**Plot its out-degree distribution on a log-log scale (omitting the nodes with out-degree 0).**

```{r, fig.align='center'}
dg_dist_out_DW_S = degree.distribution(DW_S,mode = "out")
dg_dist_out_DW_S = dg_dist_out_DW_S[dg_dist_out_DW_S != 0]
plot(dg_dist_out_DW_S, log='xy')
```

###(e)

**Do the same with its in-degree distribution.**

```{r, fig.align='center'}
dg_dist_in_DW_S = degree.distribution(DW_S,mode = "in")
dg_dist_in_DW_S = dg_dist_out_DW_S[dg_dist_in_DW_S != 0]
plot(dg_dist_in_DW_S, log='xy')
```

###(f)

**For both the in-degrees and the out-degrees, compute their range, mode, mean, median, and standard deviation. What do they tell you?**

Rango:
```{r}
range(dg_dist_in_DW_S)
range(dg_dist_out_DW_S)
```

Moda:
```{r}
sort(dg_dist_in_DW_S, decreasing = TRUE)[1]
sort(dg_dist_out_DW_S, decreasing = TRUE)[1]
```

Media:
```{r}
mean(dg_dist_in_DW_S)
mean(dg_dist_out_DW_S)
```

Mediana:
```{r}
median(dg_dist_in_DW_S)
median(dg_dist_out_DW_S)
```

Desviación estándar:
```{r}
sd(dg_dist_in_DW_S)
sd(dg_dist_out_DW_S)
```

###(g)

**What kind (or kinds) of transitivity do you consider worth studying in this network? Choose at least one, compute it, and comment the results.**

Consideramos oportuno estudiar la transitividad de doble-entrada, para medir cuantas veces, por ejemplo, si _X_ e _Y_ muestran estar conectados a _Z_, pues entonces también deben muestrar estar conectados entre sí.

Tipo de tripleta '15': A->B<->C, A<->C: 2 1
Función para transitividad de doble-entrada:

```{r}
Local_Double_In_Trans=function(G,x){
NN=induced_subgraph(G,v=as.vector(neighbors(G,v=x,mode="in")))
(sum(which_mutual(NN))/2)/choose(gorder(NN),2)
}
```
Transitividad de doble-entrada del grafo dirigido _DW_:

```{r}
Local_Double_In_Trans(DW,15)
```

Como podemos ver, se trata de un valor muy bajo, por lo que podemos considerar que tendremos más nodos con grado de entrada muy grandes y cuyos nodos que entran en ellos no estarán conectados entre sí. 
<br/> 