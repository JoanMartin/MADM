
<style type="text/css">
    body {
        background-color: #f6f7fd;
    }
    
    p {
        text-align: justify;
        text-indent: 1cm;
    }
    
    li p {
        text-indent: 0cm;
    }
    
    h1, h2, h3, h4, h5, h6 {
        color: #737aaa;
        text-decoration: underline;
    }
    
    th {  
        background-color:#737aaa;
        color: white;
        padding:5px;
    }
    
    tr:nth-child(even){
		    background: #dae5f4;
	  }
	  
	  tr:nth-child(odd){ 
		    background: #b8d1f3;
	  }
</style>

---
title: "Ejercicios R"
author: "Juan José Martín Miralles"
output: html_document
---
    
***       

<br/> 

### Titanic

```{r}
library(ggplot2)
library(jsonlite)

titanic_set = read.csv('train.csv')
```


## Ejercicio 1
```{r}
summary(titanic_set)
names(titanic_set)
str(titanic_set)
head(titanic_set, 7)
```


## Ejercicio 2
```{r}
sum(titanic_set$Sex == 'male')
sum(titanic_set$Sex == 'female')
sum(titanic_set$Age < 18, na.rm=T)
sum(titanic_set$Age < 18 & titanic_set$Survived == 1, na.rm=T)
sum(titanic_set$Age >= 10 & titanic_set$Age <= 40, na.rm=T)

table(titanic_set$Embarked)
```


## Ejercicio 3
```{r}
```


## Ejercicio 4
```{r}
mean(titanic_set$Parch)
mean(titanic_set$SibSp)
(sum(titanic_set$Parch) + sum(titanic_set$SibSp)) / nrow(titanic_set)

titanic_set$FamRel = rowSums(titanic_set[c('Parch', 'SibSp')], na.rm=TRUE)
mean(titanic_set$FamRel)
titanic_set[titanic_set$FamRel == max(titanic_set$FamRel), c('PassengerId', 'Name', 'Parch', 'SibSp', 'FamRel')]

sum(titanic_set$FamRel == 0)
```


## Ejercicio 5
```{r}
mean(titanic_set$Age, na.rm=TRUE)
titanic_set[is.na(titanic_set$Age), c('PassengerId', 'Age')]
age_mean = mean(titanic_set$Age, na.rm=TRUE)
titanic_set[c('Age')][is.na(titanic_set[c('Age')])] = age_mean
```


## Ejercicio 6
```{r}
aggregate(titanic_set$Fare~Pclass, data=titanic_set, FUN=median)

tt = table(titanic_set$Fare)
names(tt[tt == max(tt)])
names(which(tt == max(tt)))
```


## Ejercicio 7
```{r}
agg = aggregate(Age~Pclass+Sex, data=titanic_set, FUN=mean, na.rm=TRUE)

ggplot(agg, aes(x=Pclass,y=Age,fill=factor(Sex))) +
  geom_bar(stat="identity",position="dodge") +
  scale_fill_discrete(name="Sex",
                      breaks=c("male", "female"),
                      labels=c("Male", "Female")) +
  xlab("Class")+ylab("Age")


t = table(titanic_set$Pclass, titanic_set$Sex)
t = as.data.frame(t)
colnames(t)=c('Pclass', 'Sex', 'Freq')

ggplot(t, aes(x=Pclass,y=Freq,fill=factor(Sex))) +
  geom_bar(stat="identity",position="dodge") +
  scale_fill_discrete(name="Sex",
                      breaks=c("male", "female"),
                      labels=c("Male", "Female")) +
  xlab("Class")+ylab("Number of passengers")
```


## Ejercicio 8
```{r}
titanic_set[titanic_set$Age == 70, c('PassengerId', 'Name', 'Parch', 'SibSp', 'FamRel', 'Survived')]
seq = seq(0, max(titanic_set$Age) + 10, 5)
titanic_set$AgeRange = cut(titanic_set$Age, seq)
agg = aggregate(Survived~AgeRange+Sex, data=titanic_set, FUN=mean, na.rm=TRUE)
agg$Survived = agg$Survived * 100

ggplot(agg, aes(x=AgeRange,y=Survived,fill=factor(Sex))) +
    geom_bar(stat="identity",position="dodge") +
    scale_fill_discrete(name="Sex",
                        breaks=c("male", "female"),
                        labels=c("Male", "Female")) +
    xlab("Age")+ylab("Survival Percentage")
```


## Ejercicio 9
```{r}
x = toJSON(titanic_set[,c('Name', 'Pclass', 'Age')])
write(x, file="json_test.json")
y = fromJSON("json_test.json")
head(y)
```


## Ejercicio 10
```{r}
```

